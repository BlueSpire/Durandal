<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black" />
		<meta name="format-detection" content="telephone=no"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />

		<title>Docs - Building with Gulp | Durandal</title>
		<meta name="description" content="Durandal is a cross-device, cross-platform client framework written in JavaScript and designed to make Single Page Applications (SPAs) easy to create and maintain." />
		<meta name="keywords" content="Durandal, SPA, HTML5, CSS, JavaScript, Singe Page Application, Knockout, RequireJS" />
		<meta name="author" content="EisenbergEffect" />

		<meta name="generator" content="DocPad v6.60.3" />

		<link rel="apple-touch-startup-image" href="images/ios-startup-image-landscape.png" media="(orientation:landscape)" />
		<link rel="apple-touch-startup-image" href="images/ios-startup-image-portrait.png" media="(orientation:portrait)" />
		<link rel="apple-touch-icon" href="images/icon.png"/>

		<!-- Shims: IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script async src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->

		<!-- Styles -->
		<link  rel="stylesheet" href="/vendor/twitter-bootstrap/css/bootstrap.css" /><link  rel="stylesheet" href="/vendor/prettify.css" /><link  rel="stylesheet" href="/styles/style.css" />

		<script type="text/javascript">
		    if (navigator.userAgent.match(/IEMobile\/10\.0/)) {
		        var msViewportStyle = document.createElement("style");
		        var mq = "@@-ms-viewport{width:auto!important}";
		        msViewportStyle.appendChild(document.createTextNode(mq));
		        document.getElementsByTagName("head")[0].appendChild(msViewportStyle);
		    }
		</script>
		<script type="text/javascript" src="//use.typekit.net/kan0fyh.js"></script>
		<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
	</head>
	<body>
		<nav class="navbar navbar-inverse navbar-fixed-top clearfix">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="#">&nbsp;&nbsp;Durandal</a>
      </div>
      <div id="navbar" class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
          
						<li typeof="sioc:Page" about="/get-started.html" class="">
							<a href="/get-started.html" property="dc:title">Get Started</a>
						</li>
					
						<li typeof="sioc:Page" about="/downloads.html" class="">
							<a href="/downloads.html" property="dc:title">Downloads</a>
						</li>
					
						<li typeof="sioc:Page" about="/docs.html" class="">
							<a href="/docs.html" property="dc:title">Docs</a>
						</li>
					
        </ul>
				<ul class="nav navbar-nav navbar-right">
					<li>
						<a href="https://bluespire.zendesk.com" class="support">Login</a>
					</li>
				</ul>
      </div><!--/.nav-collapse -->
    </nav>

		<section class="container content docs">
  <h1 id="building-with-gulp">Building with Gulp</h1>
<h4 id="-"> </h4>
<blockquote>
<p>This article describes using the <code>gulp-durandal</code> plugin for building Durandal apps with <a href="http://gulpjs.com/">Gulp</a>.</p>
</blockquote>
<p>Both scripts and views can be compiled into a single output file with this plugin. There is no double maintenance of path mapping required. The plugin allows various code layouts (bower, app.net etc), using the paths already configured in your <code>main.js</code> file.</p>
<p>There&#39;s no need to be an expert with <a href="http://requirejs.org/docs/optimization.html">r.js&#39;s 60+ options</a>. In many cases, the following should be enough:</p>
<pre class="prettyprint linenums">gulp.task(&#39;durandal&#39;, function(){
   durandal()
      .pipe(gulp.dest(&#39;dir/to/save/the/output&#39;));
}</pre>
<h3 id="getting-started">Getting Started</h3>
<blockquote>
<p><strong>Note:</strong> This plugin requires Gulp ~3.5.5.</p>
</blockquote>
<p>If you haven&#39;t used Gulp before, be sure to check out the <a href="https://github.com/gulpjs/gulp/blob/master/docs/getting-started.md#getting-started">Getting Started guide</a>, as it explains how to create a <code>Gulpfile</code> as well as install and use Gulp plugins. Once you&#39;re familiar with that process, you may install this plugin with this command:</p>
<pre class="prettyprint linenums">npm install gulp-durandal --save-dev</pre>
<p>Once the plugin has been installed, it should be required inside your Gulpfile:</p>
<pre class="prettyprint linenums">var durandal = require(&#39;gulp-durandal&#39;);</pre>
<h3 id="the-durandal-stream">The &quot;durandal&quot; Stream</h3>
<p>This plugin compiles all the scripts and views of a Durandal project into a single js file. The task expects that the Durandal files are under a single app dir (usually named <em>app) and that there is a single main module (usually at _app/main.js</em>) that contains both the requirejs path configuration and the initial module that executes.</p>
<p>While simple and minimalistic, this task can handle all known Durandal 2.x samples and starter kits (html, bower, node, asp.net, etc.) with almost no configuration.</p>
<h3 id="overview">Overview</h3>
<p>In your project&#39;s Gulpfile, launch the plugin inside a task with the wanted configurations. The plugin will return the stream of the wanted file and it&#39;s source map.</p>
<pre class="prettyprint linenums">var durandal = require(&#39;gulp-durandal&#39;);

gulp.task(&#39;durandal&#39;, function(){
    durandal({
            baseDir: &#39;app&#39;,   //same as default, so not really required.
            main: &#39;main.js&#39;,  //same as default, so not really required.
            output: &#39;main.js&#39;, //same as default, so not really required.
            almond: true,
            minify: true
        })
        .pipe(gulp.dest(&#39;dir/to/save/the/output&#39;));
});</pre>
<p>For async tasks, handling of error and end events should be added.</p>
<pre class="prettyprint linenums">gulp.task(&#39;durandal-async&#39;, function(cb){
    durandal({
            ...
        })
        .on(&#39;error&#39;, cb)
        .pipe(gulp.dest(&#39;dir/to/save/the/output&#39;))
        .on(&#39;end&#39;, cb);</pre>
<h4 id="options">Options</h4>
<p><strong>options.verbose</strong></p>
<p>Type: Boolean, Default value: false</p>
<p>Should the task emit information about it as it progresses.</p>
<p><strong>options.baseDir</strong></p>
<p>Type: String, Default value: &#39;app&#39;</p>
<p>The path, relative to the gulp cwd, to the root directory of your durandal app (usually called <em>app</em> or <em>App</em> in the durandal starter kits and generators).</p>
<p>This directory is expected to contain all your views, viewmodels, service modules etc. All files under it are are automatically included in the output: <em>.js files as modules and text files (</em>.html, *.json) as &#39;text!&#39; prefixed modules.</p>
<p><strong>options.main</strong></p>
<p>Type: String, Default value: &#39;main.js&#39;</p>
<p>The path to the <em>main.js</em> file of the application, relative to the <em>baseDir</em>.</p>
<p>This is where we expect to find the project&#39;s requirejs.config call which defines all the path mapping for the external modules and libraries.</p>
<p>This file also contains the main module of the application.</p>
<blockquote>
<p><strong>Note:</strong> The path and module configuration done in this file is extremely important for the build too. Promoting the &#39;Single Point of Truth` principle, we do not allow any configuration or path mapping outside of this file. We believe that if it is good enough for development, it is good enough for the build.</p>
</blockquote>
<p><strong>options.output</strong></p>
<p>Type: String, Default value: <code>path.basename(options.main)</code></p>
<p>Output js file&#39;s name.</p>
<p><strong>options.minifiy</strong></p>
<p>Type: Boolean, Default value: false</p>
<p>Determines whether the output file is minified (using Uglify2).</p>
<p><strong>options.almond</strong></p>
<p>Type: Boolean|String, Default value: false</p>
<p>True to wrap the generated code and include a Durandal specific version of AlmondJS, to replace the need for the much bigger requiresjs, and create a single and self sufficient output file. (Read more about AlmondJS and the <a href="https://github.com/BlueSpire/almond">Durandal version</a>).</p>
<p>If the value is a string, it should be the path to an almond script, relative to the grunt cwd. The result is similar to setting the value to true, expect the almond script inserted is the one specified here and not the script that comes bundled with the task.</p>
<p><strong>options.extraModules</strong></p>
<p>Type: String[], Default value: []</p>
<p>A list of extra modules to include in the output file, e.g. [&#39;plugins/widget&#39;, &#39;plugins/dialog&#39;]. This can be used for all dynamically loaded modules that reside outside of the baseDir (such as Durandal&#39;s own plugins and transitions).</p>
<p>We will automatically include any module whose file is under the baseDir, as well as any of their explicit dependencies. Alas, non-explicit dependencies are not recognized automatically by r.js. If their files are outside the baseDir, they will not be recognized by our scanning process. Examples are the Durandal transitions that are loaded dynamically by convention, and Durandal plugins are loaded via <code>app.configurePlugins({ widget: true })</code>.</p>
<p>In short, all required modules must either reside under the baseDir, be an explicit dependency of a module under that dir, or be explicitly included via the extraModules option.</p>
<p>Module names are resolved and mapped to files according to the paths and mapping in the main config file, so use the same names as you would do in your code.</p>
<p><strong>options.durandalDynamicModules</strong></p>
<p>Type: Boolean, Default value: true</p>
<p>True to add default Durandal dynamic modules to <code>options.extraModules</code>. Adds all default Durandal plugins and transitions if the definition of plugins / transitions paths exists in the main config file.</p>
<p><strong>options.require</strong></p>
<p>Type: Boolean|String|String[], Default value: <code>options.almond? true : false</code></p>
<p>Determines if a &#39;require([...])&#39; call is to be inserted, and which modules are included in the list of required modules.</p>
<p>When options.almond is used, this value is true by default as almond requires usually to explicitly call require([&#39;<main module name>&#39;]), which is not the convention for require js and Durandal.</p>
<p>The tasks avoids inserting the call if the value is set to false. If it true, it will insert the <code>options.main</code> module. If you need to explicitly specify the module names, use the string or string array value.</p>
<p><strong>options.moduleFilter</strong></p>
<p>Type: Function, Default value: function(moduleName){return true;}</p>
<p>After all top level modules are resolved, they are passed via a filter function, so that you have a chance to exclude any modules for any reason you might have.</p>
<p>For example, if you would not like to include the views, you could supply the following function:</p>
<pre class="prettyprint linenums">function(moduleName){
  return moduleName.indexOf(&#39;text!&#39;) == -1;
}</pre>
<blockquote>
<p><strong>Note:</strong> This plugin is maintained by the community and is not part of the core Durandal project. More information can be found <a href="https://www.npmjs.org/package/gulp-durandal">here</a>.</p>
</blockquote>

</section>

		<footer class="footer">
		  <div class="container">
		    <p>Durandal is licensed under the <a href="https://raw.github.com/BlueSpire/Durandal/master/License.txt">MIT License</a>.</p>
		    <p>Lovingly created by <a href="http://twitter.com/eisenbergeffect" target="_blank">@eisenbergeffect</a> of <a href="http://www.bluespire.com/" target="_blank">Blue Spire</a>.</p>
		    <p>Site design crafted by <a href="https://twitter.com/@scriswell" target="_blank">@scriswell</a> of <a href="https://twitter.com/@The_UI_Guy" target="_blank">@The_UI_Guy</a> and <a href="https://twitter.com/hfjallemark" target="_blank">@hfjallemark</a>.</p>
		  </div>
		  <br />
		</footer>
		
		<script src="/vendor/jquery.js"></script>
		<script src="/vendor/twitter-bootstrap/js/bootstrap.min.js"></script>
		<script src="/vendor/modernizr.js"></script>
		<script src="/vendor/prettify.js"></script>
		<script src="/scripts/behavior.js"></script>

		

		<script type="text/javascript">
		  var _gaq = _gaq || [];
		  _gaq.push(['_setAccount', 'UA-38441871-1']);
		  _gaq.push(['_trackPageview']);

		  (function() {
		    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		  })();
		</script>
	</body>
</html>